# Arquitetura Makgora NVR

## ğŸ—ï¸ VisÃ£o Geral

Sistema hÃ­brido usando Python (FastAPI) para gerenciamento e Go para streaming.

## ğŸ“Š Componentes

### Backend Python (FastAPI) - Porta 8000
- **FunÃ§Ã£o**: CRUD de cÃ¢meras, API REST, banco de dados
- **MemÃ³ria**: ~100 MB
- **Endpoints**:
  - `GET /api/cameras` - Listar cÃ¢meras
  - `POST /api/cameras` - Criar cÃ¢mera
  - `PUT /api/cameras/{id}` - Atualizar cÃ¢mera
  - `DELETE /api/cameras/{id}` - Deletar cÃ¢mera

### ServiÃ§o Go Streaming - Porta 8001
- **FunÃ§Ã£o**: Streaming RTSP â†’ HLS
- **MemÃ³ria**: ~50-100 MB
- **Endpoints**:
  - `POST /api/stream/start/{id}` - Iniciar stream
  - `POST /api/stream/stop/{id}` - Parar stream
  - `GET /api/stream/status/{id}` - Status
  - `GET /api/stream/active` - Streams ativos

### Frontend React - Porta 5173
- **FunÃ§Ã£o**: Interface web
- **Pages**: Dashboard (Painel) + CÃ¢meras (Gerenciamento)

## ğŸ”„ Fluxo de Dados

```
Frontend (React) â†’ Python API (8000) - CRUD CÃ¢meras
                â†’ Go Streaming (8001) - Streams em tempo real
```

## ğŸ’¾ Dados

```
- Backend Python: camera_db.sqlite (SQLite)
- ServiÃ§o Go: ./streams/ (arquivos HLS temporÃ¡rios)
```

## âš¡ Performance

| ServiÃ§o | MemÃ³ria Antes | MemÃ³ria Depois |
|---------|---------------|----------------|
| Python  | ~3 GB        | ~100 MB        |
| Streaming | N/A         | ~50-100 MB     |
| **Total** | **~3 GB**  | **~200 MB**    |

## ğŸš€ Como Executar

```bash
# Terminal 1: Backend Python
cd backend
source venv/bin/activate
python -m app.main

# Terminal 2: ServiÃ§o Go Streaming
cd streaming-service
./streaming-service

# Terminal 3: Frontend
cd frontend
nvm use 20
yarn dev
```

## ğŸ“ˆ Escalabilidade

- **Python**: Horizontal (mÃºltiplas instÃ¢ncias)
- **Go**: Vertical (1 instÃ¢ncia pode lidar com 100+ streams)
- **Banco de dados**: SQLite (monolÃ­tico) â†’ PostgreSQL (futuro)

